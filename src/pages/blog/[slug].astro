---
import { getCollection } from 'astro:content';

// 1. Vygenerujeme cesty pro všechny články
export async function getStaticPaths() {
  const blogEntries = await getCollection('blog');
  return blogEntries.map(entry => ({
    params: { slug: entry.slug }, props: { entry },
  }));
}

// 2. Získáme data konkrétního článku
const { entry } = Astro.props;
const { Content } = await entry.render();
---

<html lang={entry.data.lang}>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>{entry.data.title}</title>
    <style>
        body { 
            font-family: 'Inter', sans-serif; 
            line-height: 1.8; 
            background: #18181b; /* Dark gray background */
            color: #d1d1d1; /* Jemnější bílá pro lepší čitelnost textu */
            margin: 0; 
        }
        .container { max-width: 750px; margin: 0 auto; padding: 2rem; }
        .post-frame {
            background: #fafafa; /* Softer white frame */
            border-radius: 18px;
            box-shadow: 0 4px 24px rgba(0,0,0,0.12), 0 1.5px 6px rgba(0,0,0,0.10);
            padding: 2.5rem 2rem 2rem 2rem;
            margin-bottom: 2rem;
        }
        .back-link { display: block; margin-bottom: 2rem; color: #666; text-decoration: none; font-size: 0.9rem; }
        .back-link:hover { color: #fff; }
        img.main-image { width: 100%; height: auto; margin-bottom: 3rem; object-fit: cover; border-radius: 12px; }
        h1 { font-size: 2.8rem; font-weight: 300; margin-bottom: 0.5rem; color: #111; line-height: 1.2; }
        .meta { color: #666; margin-bottom: 4rem; font-size: 0.9rem; border-bottom: 1px solid #eee; padding-bottom: 1rem; }

        /* Oprava formátování vnitřního obsahu (Markdown) */
        .content :global(h2) { color: #111; margin-top: 3rem; margin-bottom: 1rem; font-weight: 400; }
        .content :global(p) { margin-bottom: 1.6rem; color: #222; }
        .content :global(iframe) { width: 100%; border: none; margin: 3rem 0; background: #f5f5f5; border-radius: 4px; }
        
        /* Zajištění, aby odkazy v textu byly vidět */
        .content :global(a) { color: #0070f3; text-decoration: underline; text-underline-offset: 4px; }
        
        /* Styl pro seznamy, pokud je v blogu používáš */
        .content :global(ul) { margin-bottom: 1.5rem; padding-left: 1.5rem; }
        .content :global(li) { margin-bottom: 0.5rem; color: #222; }
    </style>
</head>
<body>
    <div class="container">
        <a href="/" class="back-link">← Zpět na přehled</a>
        <div class="post-frame">
        <header>
            <img src={entry.data.coverImage} alt="" class="main-image" />
            <h1>{entry.data.title}</h1>
            <p class="meta">{entry.data.date.toLocaleDateString('cs-CZ')}</p>
        </header>

        <main class="content">
            <Content />
        </main>
        <section style="margin-top:2.5rem;">
          <div id="cusdis_thread"
            data-host="https://cusdis.com"
            data-app-id="1de771b3-879c-4dc1-9b97-ef856331829a"
            data-page-id={entry.slug}
            data-page-url={Astro.url}
            data-page-title={entry.data.title}
          ></div>
          <script async defer src="https://cusdis.com/js/cusdis.es.js"></script>
          <noscript>Enable JavaScript to view the comments powered by Cusdis.</noscript>
        </section>
        </div>
    </div>
</body>
</html>